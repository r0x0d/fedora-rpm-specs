# Generated by go2rpm 1.14.0
%bcond check 1
%bcond bootstrap 0

%global debug_package %{nil}

%if %{with bootstrap}
%global __requires_exclude %{?__requires_exclude:%{__requires_exclude}|}^golang\\(.*\\)$
%endif

# https://github.com/pdevine/tensor
%global goipath         github.com/pdevine/tensor
%global commit          f88f4562727c20425d4b6cad576a4401aa4caa63
%global date            20240510

%gometa -L -f

%global common_description %{expand:
Package tensor provides efficient and generic n-dimensional arrays in Go that
are useful for machine learning and deep learning purposes.}

%global golicenses      LICENCE
%global godocs          CONTRIBUTING.md CONTRIBUTORS.md README.md

Name:           golang-github-pdevine-tensor
Version:        0
Release:        %autorelease -p
Summary:        Package tensor provides efficient and generic n-dimensional arrays in Go

License:        Apache-2.0
URL:            %{gourl}
Source:         %{gosource}
Patch0:         0001-Remove-FromArrow-functions.patch

%description %{common_description}

%if %{with check}
%endif

%gopkg

%prep
%goprep -A
%autopatch -p1

# Some lingering urls from the fork remain
sed -i -e 's@gorgonia.org/tensor@github.com/pdevine/tensor@' internal/execution/e.go
sed -i -e 's@gorgonia.org/tensor@github.com/pdevine/tensor@' internal/serialization/pb/generated.pb.go
sed -i -e 's@gorgonia.org/tensor@github.com/pdevine/tensor@' internal/storage/header.go
sed -i -e 's@gorgonia.org/tensor@github.com/pdevine/tensor@' tensor.go

# rm test that depends on flakey python setup
rm dense_io_test.go
# example_iterator_test.go:54:1: ExampleSliceIter refers to unknown identifier: SliceIter
rm example_iterator_test.go
# ./example_dense_arith_test.go:2174:2: output comment block must be the last comment block
rm example_dense_arith_test.go

%if %{without bootstrap}
%generate_buildrequires
%go_generate_buildrequires
%endif

%install
%gopkginstall

%if %{without bootstrap}
%if %{with check}
%check
%gocheck
%endif
%endif

%gopkgfiles

%changelog
%autochangelog
