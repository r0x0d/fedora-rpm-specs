# Generated by rust2rpm 27
%bcond check 1

%global crate bat

Name:           rust-bat
Version:        0.25.0
Release:        %autorelease
Summary:        Cat(1) clone with wings

# * bat crate: MIT OR Apache-2.0
# * bundled content: Apache-2.0, BSD-2-Clause, BSD-2-Clause-Views, BSD-3-Clause, CC-BY-SA-3.0, MIT, Unlicense, WTFPL, UltraPermissive
License:        (MIT OR Apache-2.0) AND Apache-2.0 AND BSD-2-Clause AND BSD-2-Clause-Views AND BSD-3-Clause AND CC-BY-SA-3.0 AND MIT AND Unlicense AND WTFPL AND LicenseRef-Fedora-UltraPermissive
URL:            https://crates.io/crates/bat
Source:         %{crates_source}
# Automatically generated patch to strip dependencies and normalize metadata
Patch:          bat-fix-metadata-auto.diff
# Manually created patch for downstream crate metadata changes
# * port from path_abs to path-absolutize:
#   https://github.com/sharkdp/bat/pull/1025
# * adapt license tag to reflect bundled content
# * drop unused lessopen feature and its dependencies
Patch:          bat-fix-metadata.diff
Patch:          0001-port-from-path_abs-to-path-absolutize.patch

BuildRequires:  cargo-rpm-macros >= 24

%global _description %{expand:
A cat(1) clone with wings.}

%global _bundled_deps %{expand:
# Sublime Text 3 language definitions for syntax highlighting
# from: https://github.com/sublimehq/Packages/tree/759d6ee
# - all except Rust: LicenseRef-Fedora-UltraPermissive
#   https://gitlab.com/fedora/legal/fedora-license-data/-/issues/516
# - Rust: MIT
Provides:       bundled(sublime-syntax) = 4075~git759d6ee

# third-party language definitions for syntax highlighting
# AWK: MIT
Provides:       bundled(sublime-syntax-AWK)
# Ada: MIT
Provides:       bundled(sublime-syntax-Ada)
# Apache: BSD-2-Clause-Views
Provides:       bundled(sublime-syntax-Apache)
# AsciiDoc: MIT
Provides:       bundled(sublime-syntax-AsciiDoc)
# CMake: MIT
Provides:       bundled(sublime-syntax-CMake)
# CoffeeScript: MIT
Provides:       bundled(sublime-syntax-CoffeeScript)
# Crontab: MIT
Provides:       bundled(sublime-syntax-Crontab)
# Crontab/cron_descriptor: MIT
Provides:       bundled(sublime-syntax-Crontab-cron_descriptor)
# Crystal: Apache-2.0
Provides:       bundled(sublime-syntax-Crystal)
# Dart: MIT
Provides:       bundled(sublime-syntax-Dart)
# Docker: MIT
Provides:       bundled(sublime-syntax-Docker)
# DotENV: MIT
Provides:       bundled(sublime-syntax-DotENV)
# Elixir: MIT
Provides:       bundled(sublime-syntax-Elixir)
# Elm: MIT
Provides:       bundled(sublime-syntax-Elm)
# Email: MIT
Provides:       bundled(sublime-syntax-Email)
# Fish: MIT
Provides:       bundled(sublime-syntax-Fish)
# GLSL: Unlicense
Provides:       bundled(sublime-syntax-GLSL)
# GraphQL: WTFPL
Provides:       bundled(sublime-syntax-GraphQL)
# Groff: MIT
Provides:       bundled(sublime-syntax-Groff)
# HTML (Twig): BSD-3-Clause
Provides:       bundled(sublime-syntax-HTML-Twig)
# JavaScript (Babel): MIT
Provides:       bundled(sublime-syntax-JavaScript-Babel)
# Jsonnet: Apache-2.0
Provides:       bundled(sublime-syntax-Jsonnet)
# Julia: MIT
Provides:       bundled(sublime-syntax-Julia)
# Kotlin: Apache-2.0
Provides:       bundled(sublime-syntax-Kotlin)
# LLVM: MIT
Provides:       bundled(sublime-syntax-LLVM)
# Lean: Apache-2.0
Provides:       bundled(sublime-syntax-Lean)
# LiveScript: MIT
Provides:       bundled(sublime-syntax-LiveScript)
# MediaWiki: MIT
Provides:       bundled(sublime-syntax-MediaWiki)
# NSIS: Apache-2.0
Provides:       bundled(sublime-syntax-NSIS)
# Nginx: MIT
Provides:       bundled(sublime-syntax-Nginx)
# Ninja: MIT
Provides:       bundled(sublime-syntax-Ninja)
# Nix: MIT
Provides:       bundled(sublime-syntax-Nix)
# Org mode: BSD-2-Clause
Provides:       bundled(sublime-syntax-Org-mode)
# PowerShell: MIT
Provides:       bundled(sublime-syntax-PowerShell)
# Protobuf: MIT
Provides:       bundled(sublime-syntax-Protobuf)
# Puppet: MIT
Provides:       bundled(sublime-syntax-Puppet)
# PureScript: MIT AND Unlicense
Provides:       bundled(sublime-syntax-PureScript)
# QML: MIT
Provides:       bundled(sublime-syntax-QML)
# Robot: MIT
Provides:       bundled(sublime-syntax-Robot)
# SCSS_Sass: MIT
Provides:       bundled(sublime-syntax-SCSS_Sass)
# SLS: Apache-2.0
Provides:       bundled(sublime-syntax-SLS)
# Slim: MIT
Provides:       bundled(sublime-syntax-Slim)
# Stylus: MIT
Provides:       bundled(sublime-syntax-Stylus)
# SublimeEthereum: MIT
Provides:       bundled(sublime-syntax-SublimeEthereum)
# Svelte: MIT
Provides:       bundled(sublime-syntax-Svelte)
# Swift: MIT
Provides:       bundled(sublime-syntax-Swift)
# SystemVerilog: MIT
Provides:       bundled(sublime-syntax-SystemVerilog)
# TOML: MIT
Provides:       bundled(sublime-syntax-TOML)
# Terraform: MIT
Provides:       bundled(sublime-syntax-Terraform)
# TypeScript: MIT
Provides:       bundled(sublime-syntax-TypeScript)
# VimL: MIT
Provides:       bundled(sublime-syntax-VimL)
# Vue: MIT
Provides:       bundled(sublime-syntax-Vue)
# Zig: MIT
Provides:       bundled(sublime-syntax-Zig)
# cmd-help: MIT
Provides:       bundled(sublime-syntax-cmd-help)
# gnuplot: MIT
Provides:       bundled(sublime-syntax-gnuplot)
# hosts: MIT
Provides:       bundled(sublime-syntax-hosts)
# http-request-response: MIT
Provides:       bundled(sublime-syntax-http-request-response)
# varlink: MIT
Provides:       bundled(sublime-syntax-varlink)
# vscode-wgsl: MIT
Provides:       bundled(sublime-syntax-vscode-wgsl)

# third-party themes for syntax highlighting
# 1337-Scheme: MIT
Provides:       bundled(sublime-theme-1337-Scheme)
# Coldark: MIT
Provides:       bundled(sublime-theme-Coldark)
# DarkNeon: CC-BY-SA-3.0
Provides:       bundled(sublime-theme-DarkNeon)
# Nord-sublime: MIT, https://github.com/sharkdp/bat/issues/2987
Provides:       bundled(sublime-theme-Nord-sublime)
# Solarized: MIT
Provides:       bundled(sublime-theme-Solarized)
# TwoDark: MIT
Provides:       bundled(sublime-theme-TwoDark)
# dracula-sublime: MIT
Provides:       bundled(sublime-theme-dracula-sublime)
# github-sublime-theme: https://github.com/sharkdp/bat/issues/2984
Provides:       bundled(sublime-theme-github-sublime-theme)
# gruvbox: MIT
Provides:       bundled(sublime-theme-gruvbox)
# onehalf: MIT
Provides:       bundled(sublime-theme-onehalf)
# sublime-monokai-extended: MIT
Provides:       bundled(sublime-theme-sublime-monokai-extended)
# sublime-snazzy: https://github.com/sharkdp/bat/issues/2985
Provides:       bundled(sublime-theme-sublime-snazzy)
# visual-studio-dark-plus: https://github.com/sharkdp/bat/issues/2986
Provides:       bundled(sublime-theme-visual-studio-dark-plus)
# zenburn: BSD-2-Clause-Views
Provides:       bundled(sublime-theme-zenburn)
}

%description %{_description}

%package     -n %{crate}
Summary:        %{summary}

%{_bundled_deps}

# (Apache-2.0 OR MIT) AND BSD-3-Clause
# (MIT OR Apache-2.0) AND Apache-2.0 AND BSD-2-Clause AND BSD-2-Clause-Views AND BSD-3-Clause AND CC-BY-SA-3.0 AND MIT AND Unlicense AND WTFPL
# (MIT OR Apache-2.0) AND BSD-3-Clause AND GPL-2.0-only WITH GCC-exception-2.0 AND MIT
# (MIT OR Apache-2.0) AND Unicode-DFS-2016
# 0BSD OR MIT OR Apache-2.0
# Apache-2.0
# Apache-2.0 OR BSL-1.0
# Apache-2.0 OR MIT
# Apache-2.0 WITH LLVM-exception OR Apache-2.0 OR MIT
# BSD-2-Clause
# LGPL-3.0-or-later
# MIT
# MIT OR Apache-2.0
# MIT OR Apache-2.0 OR Zlib
# MIT OR Zlib OR Apache-2.0
# Unlicense OR MIT
# Zlib OR Apache-2.0 OR MIT
License:        Apache-2.0 AND BSD-2-Clause AND BSD-2-Clause-Views AND BSD-3-Clause AND CC-BY-SA-3.0 AND LGPL-3.0-or-later AND GPL-2.0-only WITH GCC-exception-2.0 AND MIT AND Unicode-DFS-2016 AND Unlicense AND WTFPL AND (0BSD OR MIT OR Apache-2.0) AND (Apache-2.0 OR BSL-1.0) AND (Apache-2.0 OR MIT) AND (Apache-2.0 WITH LLVM-exception OR Apache-2.0 OR MIT) AND (MIT OR Apache-2.0 OR Zlib) AND (Unlicense OR MIT)
# LICENSE.dependencies contains a full license breakdown

%description -n %{crate} %{_description}

%files       -n %{crate}
%license LICENSE-APACHE
%license LICENSE-MIT
%license NOTICE
%license LICENSE.dependencies
%doc CHANGELOG.md
%doc CONTRIBUTING.md
%doc README.md
%{_bindir}/bat
%{_mandir}/man1/bat.1*
%{bash_completions_dir}/bat.bash
%{fish_completions_dir}/bat.fish
%{zsh_completions_dir}/_bat

%package        devel
Summary:        %{summary}
BuildArch:      noarch

%{_bundled_deps}

%description    devel %{_description}

This package contains library source intended for building other packages which
use the "%{crate}" crate.

%files          devel
%license %{crate_instdir}/LICENSE-APACHE
%license %{crate_instdir}/LICENSE-MIT
%license %{crate_instdir}/NOTICE
%doc %{crate_instdir}/CHANGELOG.md
%doc %{crate_instdir}/CONTRIBUTING.md
%doc %{crate_instdir}/README.md
%{crate_instdir}/

%package     -n %{name}+default-devel
Summary:        %{summary}
BuildArch:      noarch

%description -n %{name}+default-devel %{_description}

This package contains library source intended for building other packages which
use the "default" feature of the "%{crate}" crate.

%files       -n %{name}+default-devel
%ghost %{crate_instdir}/Cargo.toml

%package     -n %{name}+application-devel
Summary:        %{summary}
BuildArch:      noarch

%description -n %{name}+application-devel %{_description}

This package contains library source intended for building other packages which
use the "application" feature of the "%{crate}" crate.

%files       -n %{name}+application-devel
%ghost %{crate_instdir}/Cargo.toml

%package     -n %{name}+bugreport-devel
Summary:        %{summary}
BuildArch:      noarch

%description -n %{name}+bugreport-devel %{_description}

This package contains library source intended for building other packages which
use the "bugreport" feature of the "%{crate}" crate.

%files       -n %{name}+bugreport-devel
%ghost %{crate_instdir}/Cargo.toml

%package     -n %{name}+build-assets-devel
Summary:        %{summary}
BuildArch:      noarch

%description -n %{name}+build-assets-devel %{_description}

This package contains library source intended for building other packages which
use the "build-assets" feature of the "%{crate}" crate.

%files       -n %{name}+build-assets-devel
%ghost %{crate_instdir}/Cargo.toml

%package     -n %{name}+clap-devel
Summary:        %{summary}
BuildArch:      noarch

%description -n %{name}+clap-devel %{_description}

This package contains library source intended for building other packages which
use the "clap" feature of the "%{crate}" crate.

%files       -n %{name}+clap-devel
%ghost %{crate_instdir}/Cargo.toml

%package     -n %{name}+etcetera-devel
Summary:        %{summary}
BuildArch:      noarch

%description -n %{name}+etcetera-devel %{_description}

This package contains library source intended for building other packages which
use the "etcetera" feature of the "%{crate}" crate.

%files       -n %{name}+etcetera-devel
%ghost %{crate_instdir}/Cargo.toml

%package     -n %{name}+git-devel
Summary:        %{summary}
BuildArch:      noarch

%description -n %{name}+git-devel %{_description}

This package contains library source intended for building other packages which
use the "git" feature of the "%{crate}" crate.

%files       -n %{name}+git-devel
%ghost %{crate_instdir}/Cargo.toml

%package     -n %{name}+git2-devel
Summary:        %{summary}
BuildArch:      noarch

%description -n %{name}+git2-devel %{_description}

This package contains library source intended for building other packages which
use the "git2" feature of the "%{crate}" crate.

%files       -n %{name}+git2-devel
%ghost %{crate_instdir}/Cargo.toml

%package     -n %{name}+grep-cli-devel
Summary:        %{summary}
BuildArch:      noarch

%description -n %{name}+grep-cli-devel %{_description}

This package contains library source intended for building other packages which
use the "grep-cli" feature of the "%{crate}" crate.

%files       -n %{name}+grep-cli-devel
%ghost %{crate_instdir}/Cargo.toml

%package     -n %{name}+minimal-application-devel
Summary:        %{summary}
BuildArch:      noarch

%description -n %{name}+minimal-application-devel %{_description}

This package contains library source intended for building other packages which
use the "minimal-application" feature of the "%{crate}" crate.

%files       -n %{name}+minimal-application-devel
%ghost %{crate_instdir}/Cargo.toml

%package     -n %{name}+paging-devel
Summary:        %{summary}
BuildArch:      noarch

%description -n %{name}+paging-devel %{_description}

This package contains library source intended for building other packages which
use the "paging" feature of the "%{crate}" crate.

%files       -n %{name}+paging-devel
%ghost %{crate_instdir}/Cargo.toml

%package     -n %{name}+regex-devel
Summary:        %{summary}
BuildArch:      noarch

%description -n %{name}+regex-devel %{_description}

This package contains library source intended for building other packages which
use the "regex" feature of the "%{crate}" crate.

%files       -n %{name}+regex-devel
%ghost %{crate_instdir}/Cargo.toml

%package     -n %{name}+regex-fancy-devel
Summary:        %{summary}
BuildArch:      noarch

%description -n %{name}+regex-fancy-devel %{_description}

This package contains library source intended for building other packages which
use the "regex-fancy" feature of the "%{crate}" crate.

%files       -n %{name}+regex-fancy-devel
%ghost %{crate_instdir}/Cargo.toml

%package     -n %{name}+regex-onig-devel
Summary:        %{summary}
BuildArch:      noarch

%description -n %{name}+regex-onig-devel %{_description}

This package contains library source intended for building other packages which
use the "regex-onig" feature of the "%{crate}" crate.

%files       -n %{name}+regex-onig-devel
%ghost %{crate_instdir}/Cargo.toml

%package     -n %{name}+shell-words-devel
Summary:        %{summary}
BuildArch:      noarch

%description -n %{name}+shell-words-devel %{_description}

This package contains library source intended for building other packages which
use the "shell-words" feature of the "%{crate}" crate.

%files       -n %{name}+shell-words-devel
%ghost %{crate_instdir}/Cargo.toml

%package     -n %{name}+walkdir-devel
Summary:        %{summary}
BuildArch:      noarch

%description -n %{name}+walkdir-devel %{_description}

This package contains library source intended for building other packages which
use the "walkdir" feature of the "%{crate}" crate.

%files       -n %{name}+walkdir-devel
%ghost %{crate_instdir}/Cargo.toml

%package     -n %{name}+wild-devel
Summary:        %{summary}
BuildArch:      noarch

%description -n %{name}+wild-devel %{_description}

This package contains library source intended for building other packages which
use the "wild" feature of the "%{crate}" crate.

%files       -n %{name}+wild-devel
%ghost %{crate_instdir}/Cargo.toml

%prep
%autosetup -n %{crate}-%{version} -p1
%cargo_prep

%generate_buildrequires
%cargo_generate_buildrequires

%build
%cargo_build
%{cargo_license_summary}
%{cargo_license} > LICENSE.dependencies

%install
%cargo_install
# install man page
install -Dpm0644 target/release/build/%{crate}-*/out/assets/manual/bat.1 \
    -t %{buildroot}%{_mandir}/man1/
# install shell completions
install -Dpm0644 target/release/build/%{crate}-*/out/assets/completions/bat.bash \
    %{buildroot}/%{bash_completions_dir}/bat.bash
install -Dpm0644 target/release/build/%{crate}-*/out/assets/completions/bat.fish \
    %{buildroot}/%{fish_completions_dir}/bat.fish
install -Dpm0644 target/release/build/%{crate}-*/out/assets/completions/bat.zsh \
    %{buildroot}/%{zsh_completions_dir}/_bat

%if %{with check}
%check
%cargo_test
%endif

%changelog
%autochangelog
