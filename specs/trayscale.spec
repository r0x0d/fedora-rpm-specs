# Generated by go2rpm 1.9.0
%bcond_without vendor
%if %{without vendor}
%bcond_without check
%endif

# needed for vendored deps
%global gomodulesmode GO111MODULE=on

# https://github.com/DeedleFake/trayscale
%global goipath         github.com/DeedleFake/trayscale
Version:                0.14.1

%if 0%{?rhel}
%gometa
%else
%gometa -f
%endif

%global common_description %{expand:
An unofficial GUI wrapper around the Tailscale CLI client.}

%global golicenses      LICENSE
%global godocs          README.md

Name:           trayscale
Release:        1%{?dist}
Summary:        An unofficial GUI wrapper around the Tailscale CLI client

# main source code is MIT
# see comments above provides tags for bundled license breakdown
License:        MIT AND BSD-2-Clause AND Apache-2.0 AND MPL-2.0 AND ISC AND BSD-3-Clause
URL:            %{gourl}
# see create-vendor-tarball.sh in this distgit repo
Source0:        trayscale-%{version}-vendored.tar.xz
Source99:       create-vendor-tarball.sh

BuildRequires:          glib2-devel
BuildRequires:          gobject-introspection-devel
BuildRequires:          graphene-devel
BuildRequires:          cairo-devel
BuildRequires:          pango-devel
BuildRequires:          gdk-pixbuf2-devel
BuildRequires:          cairo-gobject-devel
BuildRequires:          gtk4-devel
BuildRequires:          libadwaita-devel
BuildRequires:          desktop-file-utils
BuildRequires:          libappstream-glib

Requires:               hicolor-icon-theme

# MIT
Provides:       bundled(golang(deedles.dev/mk)) = v0.1.0
# MIT
Provides:       bundled(golang(deedles.dev/xiter)) = v0.1.0
# Apache-2.0
Provides:       bundled(golang(fyne.io/systray)) = v1.11.0
# MPL-2.0
Provides:       bundled(golang(github.com/diamondburned/gotk4-adwaita/pkg)) = v0.0.0~20240712143708~824c3ce8a5f4
# MPL-2.0
Provides:       bundled(golang(github.com/diamondburned/gotk4/pkg)) = v0.3.1
# BSD-3-Clause
Provides:       bundled(golang(github.com/inhies/go-bytesize)) = v0.0.0~20220417184213~4913239db9cf
# BSD-3-Clause
Provides:       bundled(golang(golang.org/x/net)) = v0.31.0
# MIT OR BSD-3-Clause
Provides:       bundled(golang(honnef.co/go/tools)) = v0.5.1
# BSD-3-Clause
Provides:       bundled(golang(tailscale.com)) = v1.76.6
# BSD-3-Clause
Provides:       bundled(golang(filippo.io/edwards25519)) = v1.1.0
# MIT
Provides:       bundled(golang(github.com/BurntSushi/toml)) = v1.4.1~0.20240615085220~eb727477b3f7
# MIT
Provides:       bundled(golang(github.com/KarpelesLab/weak)) = v0.1.1
# Apache-2.0
Provides:       bundled(golang(github.com/akutz/memconn)) = v0.1.0
# BSD-3-Clause
Provides:       bundled(golang(github.com/alexbrainman/sspi)) = v0.0.0~20231016080023~1a75b4708caa
# ISC
Provides:       bundled(golang(github.com/coder/websocket)) = v1.8.12
# Apache-2.0
Provides:       bundled(golang(github.com/coreos/go-iptables)) = v0.8.0
# BSD-3-Clause
Provides:       bundled(golang(github.com/dblohm7/wingoes)) = v0.0.0~20240820181039~f2b84150679e
# MIT
Provides:       bundled(golang(github.com/fxamacker/cbor/v2)) = v2.7.0
# BSD-3-Clause
Provides:       bundled(golang(github.com/go-json-experiment/json)) = v0.0.0~20240815175050~ebd3a8989ca1
# BSD-2-Clause
Provides:       bundled(golang(github.com/godbus/dbus/v5)) = v5.1.1~0.20230522191255~76236955d466
# Apache-2.0
Provides:       bundled(golang(github.com/golang/groupcache)) = v0.0.0~20210331224755~41bb18bfe9da
# BSD-3-Clause
Provides:       bundled(golang(github.com/google/go-cmp)) = v0.6.0
# Apache-2.0
Provides:       bundled(golang(github.com/google/nftables)) = v0.2.1~0.20240902164806~9a9f2ce6b319
# BSD-3-Clause
Provides:       bundled(golang(github.com/google/uuid)) = v1.6.0
# BSD-3-Clause
Provides:       bundled(golang(github.com/gorilla/csrf)) = v1.7.2
# BSD-3-Clause
Provides:       bundled(golang(github.com/gorilla/securecookie)) = v1.1.2
# BSD-3-Clause
Provides:       bundled(golang(github.com/hdevalence/ed25519consensus)) = v0.2.0
# MIT
Provides:       bundled(golang(github.com/josharian/native)) = v1.1.1~0.20230202152459~5c7d0dd6ab86
# MIT
Provides:       bundled(golang(github.com/jsimonetti/rtnetlink)) = v1.4.2
# MIT
Provides:       bundled(golang(github.com/kballard/go-shellquote)) = v0.0.0~20180428030007~95032a82bc51
# MIT
Provides:       bundled(golang(github.com/mattn/go-colorable)) = v0.1.13
# MIT
Provides:       bundled(golang(github.com/mattn/go-isatty)) = v0.0.20
# MIT
Provides:       bundled(golang(github.com/mdlayher/netlink)) = v1.7.2
# MIT
Provides:       bundled(golang(github.com/mdlayher/socket)) = v0.5.1
# BSD-3-Clause
Provides:       bundled(golang(github.com/miekg/dns)) = v1.1.62
# MIT
Provides:       bundled(golang(github.com/mitchellh/go-ps)) = v1.0.0
# Apache-2.0
Provides:       bundled(golang(github.com/peterbourgon/ff/v3)) = v3.4.0
# MIT
Provides:       bundled(golang(github.com/skip2/go-qrcode)) = v0.0.0~20200617195104~da1b6568686e
# MIT
Provides:       bundled(golang(github.com/tailscale/go-winio)) = v0.0.0~20231025203758~c4f33415bf55
# BSD-2-Clause
Provides:       bundled(golang(github.com/tailscale/goupnp)) = v1.0.1~0.20210804030727~66b27ba4e403
# Apache-2.0
Provides:       bundled(golang(github.com/tailscale/netlink)) = v1.1.1~0.20240822203006~4d49adab4de7
# BSD-3-Clause
Provides:       bundled(golang(github.com/tailscale/web-client-prebuilt)) = v0.0.0~20240226180453~5db17b287bf1
# MIT
Provides:       bundled(golang(github.com/tcnksm/go-httpstat)) = v0.2.0
# MIT
Provides:       bundled(golang(github.com/toqueteos/webbrowser)) = v1.2.0
# Apache-2.0
Provides:       bundled(golang(github.com/vishvananda/netns)) = v0.0.5
# MIT
Provides:       bundled(golang(github.com/x448/float16)) = v0.8.4
# Apache-2.0
Provides:       bundled(golang(go4.org/mem)) = v0.0.0~20240501181205~ae6ca9944745
# BSD-3-Clause
Provides:       bundled(golang(go4.org/netipx)) = v0.0.0~20231129151722~fdeea329fbba
# BSD-3-Clause
Provides:       bundled(golang(go4.org/unsafe/assume-no-moving-gc)) = v0.0.0~20231121144256~b99613f794b6
# BSD-3-Clause
Provides:       bundled(golang(golang.org/x/crypto)) = v0.29.0
# BSD-3-Clause
Provides:       bundled(golang(golang.org/x/exp)) = v0.0.0~20241108190413~2d47ceb2692f
# BSD-3-Clause
Provides:       bundled(golang(golang.org/x/exp/typeparams)) = v0.0.0~20241108190413~2d47ceb2692f
# BSD-3-Clause
Provides:       bundled(golang(golang.org/x/mod)) = v0.22.0
# BSD-3-Clause
Provides:       bundled(golang(golang.org/x/oauth2)) = v0.24.0
# BSD-3-Clause
Provides:       bundled(golang(golang.org/x/sync)) = v0.9.0
# BSD-3-Clause
Provides:       bundled(golang(golang.org/x/sys)) = v0.27.0
# BSD-3-Clause
Provides:       bundled(golang(golang.org/x/text)) = v0.20.0
# BSD-3-Clause
Provides:       bundled(golang(golang.org/x/time)) = v0.8.0
# BSD-3-Clause
Provides:       bundled(golang(golang.org/x/tools)) = v0.27.0
# MIT
Provides:       bundled(golang(golang.zx2c4.com/wireguard/windows)) = v0.5.3
# Apache-2.0
Provides:       bundled(golang(k8s.io/client-go)) = v0.31.2
# MIT OR BSD-3-Clause OR Apache-2.0
Provides:       bundled(golang(sigs.k8s.io/yaml)) = v1.4.0
# BSD-3-Clause
Provides:       bundled(golang(software.sslmate.com/src/go-pkcs12)) = v0.5.0

%description %{common_description}

%if %{without vendor}
%gopkg
%endif


%prep
%if %{without vendor}
rm -rf vendor/
%endif

%goprep %{?with_vendor:-k}


%build
%gobuild -o trayscale ./cmd/trayscale


%install
%if %{without vendor}
%gopkginstall
%else
install -D -t %{buildroot}%{_bindir} trayscale
install -Dm644 -t %{buildroot}%{_datadir}/applications dev.deedles.Trayscale.desktop
install -Dm644 -t %{buildroot}%{_datadir}/icons/hicolor/256x256/apps dev.deedles.Trayscale.png
install -Dm644 -t %{buildroot}%{_metainfodir} dev.deedles.Trayscale.metainfo.xml
%endif


%check
desktop-file-validate %{buildroot}%{_datadir}/applications/dev.deedles.Trayscale.desktop
appstream-util validate-relax --nonet %{buildroot}%{_metainfodir}/dev.deedles.Trayscale.metainfo.xml
%if %{with check}
%gocheck
%endif


%files
%license LICENSE
%doc README.md
%{_bindir}/trayscale
%{_datadir}/applications/dev.deedles.Trayscale.desktop
%{_datadir}/icons/hicolor/*/apps/dev.deedles.Trayscale.png
%{_metainfodir}/dev.deedles.Trayscale.metainfo.xml


%if %{without vendor}
%gopkgfiles
%endif


%changelog
* Fri Jan 03 2025 Jonathan Wright <jonathan@almalinux.org> - 0.14.1-1
- update to 0.14.1 rhbz#2333617

* Fri Nov 22 2024 Jonathan Wright <jonathan@almalinux.org> - 0.14.0-1
- update to 0.14.0 rhbz#2305263

* Mon Aug 12 2024 Jonathan Wright <jonathan@almalinux.org> - 0.13.1-1
- update to 1.13.1 rhbz#2304060

* Thu Aug 08 2024 Jonathan Wright <jonathan@almalinux.org> - 0.13.0-1
- update to 0.13.0 rhbz#2303697

* Sat Jul 20 2024 Fedora Release Engineering <releng@fedoraproject.org> - 0.12.6-2
- Rebuilt for https://fedoraproject.org/wiki/Fedora_41_Mass_Rebuild

* Tue Jul 09 2024 Jonathan Wright <jonathan@almalinux.org> - 0.12.6-1
- update to 0.12.6

* Thu May 30 2024 Jonathan Wright <jonathan@almalinux.org> - 0.12.3-1
- Initial package build

