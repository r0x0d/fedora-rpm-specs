# Generated by go2rpm 1.15.0
%bcond check 1

# https://github.com/johnkerl/miller
%global goipath         github.com/johnkerl/miller/v6
Version:                6.13.0

%gometa -L -f

%global common_description %{expand:
Miller is like awk, sed, cut, join, and sort for name-indexed data such as CSV,
TSV, and tabular JSON.

With Miller, you get to use named fields without needing to count positional
indices, using familiar formats such as CSV, TSV, JSON, JSON Lines, and
positionally-indexed. Then, on the fly, you can add new fields which are
functions of existing fields, drop fields, sort, aggregate statistically,
pretty-print, and more.}

Name:           miller
Release:        %autorelease
Summary:        Name-indexed data processing tool

# Generated by go-vendor-tools
License:        Apache-2.0 AND BSD-2-Clause AND BSD-3-Clause AND ISC AND MIT
URL:            %{gourl}
Source0:        %{gosource}
# Generated by go-vendor-tools
Source1:        %{archivename}-vendor.tar.bz2
Source2:        go-vendor-tools.toml
# https://github.com/johnkerl/miller/pull/1745
Patch:          miller-go1_24-non_constant_string.diff

BuildRequires:  go-vendor-tools

%description %{common_description}

%prep
%goprep -A
%setup -q -T -D -a1 %{forgesetupargs}
%autopatch -p1

# These should not be shipped
rm -rf cmd/experiments

%generate_buildrequires
%go_vendor_license_buildrequires -c %{S:2}

%build
for cmd in cmd/mlr ; do
  %gobuild -o %{gobuilddir}/bin/$(basename $cmd) %{goipath}/$cmd
done

%install
%go_vendor_license_install -c %{S:2}
install -m 0755 -vd                     %{buildroot}%{_bindir}
install -m 0755 -vp %{gobuilddir}/bin/* %{buildroot}%{_bindir}/

%check
%go_vendor_license_check -c %{S:2}
%if %{with check}
%gocheck
%endif

%files -f %{go_vendor_license_filelist}
%license vendor/modules.txt
%doc README-RPM.md README-dev.md README-docs.md README-go-port.md
%doc README-profiling.md README-versions.md README.md todo.txt xtodo.txt
%{_bindir}/mlr


%changelog
%autochangelog
